<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedheader/3.1.2/css/fixedHeader.dataTables.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<!-- html2canvas library -->

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>

<!-- Polyfills for wkhtmltopdf -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.10/es5-shim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-sham.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/es7-shim/6.0.0/es7-shim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.16.0/polyfill.min.js"></script>
<title>DIET INDEX</title>
<STYLE>
@page {
    size: letter landscape;
    margin: 2cm;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
  padding:15px;
}
.sectortable {
width:1250px;
text-align:center;
}
.r1{
border: 1px 0px;
}
.sectortable th{
background-color:#00B0F0;
color: white;
border: 1px solid white;
  border-collapse: collapse;
  padding:15px;
}

.sectortable td{

color: black;
border: 1px solid #00B0F0;
  padding:25px;
  height:60px;
}

.rate {
background-color: #c7e0f4;

}

.stockdata {
border: 0px ;
  border-collapse: collapse;
    padding:5px;



}

.Indexdiet{
padding: 10px;
}
.stockdata tr:nth-child(even) {
  background-color: #98503C;
  COLOR: WHITE;
}
.stockdata tr:nth-child(odd) {
  COLOR: #00B0F0;
}
.info{
padding: 10px;
border:0px;
}
</STYLE>
<div id="contentToPrint">
    <div class="Indexdiet">
        <h3>
            <b>Q2FY22 Earnings DEIT Index</b>
        </h3>
        <table style="width:600px; height:150px;">
            <tr style="background-color:#FFC000
; COLOR:BLACK;">
                <th>EPS (Cumulative = 181)</th>
                <th>0-5%</th>
                <th>5-10%</th>
                <th>>10%</th>
                <th>DART Earnings Index</th>
            </tr>
            <tr style="background-color:#92D050; COLOR:WHITE;">
                <th>Upgrade</th>
                <td>56</td>
                <td>17</td>
                <td>20</td>
                <td>93</td>
            </tr>
            <tr style="background-color:#FF0000; COLOR:WHITE;">
                <th>Downgrade</th>
                <td>44</td>
                <td>17</td>
                <td>27</td>
                <td>88</td>
            </tr>
        </table> <br>
        <div style="width:1220px; height:60px; padding:15px;background-color:#0066B3">
            <h3><center style="color:white;">DART Earnings Index Trajectory (DEIT)</center></h3>
        </div>
        <div>
<img src="D:\projects\Dolat\staticfiles\pic\Screenshot 2022-01-14 164553.png" width="1500 px;"height="850px;">
            <!--<canvas id="myChart"></canvas>-->
        </div>
<br><br><br>
        <div>
        <table>
            <tr style="background-color:#92D050; COLOR:white;">
                <td>DEIT > 1</td>
                <td>More Upgrades vs Downgrades</td>
            </tr>
            <tr style="background-color:#00B0F0; COLOR:white;">
                <td>DEIT = 1</td>
                <td>Equal weight of Upgrades vs Downgrades</td>
            </tr>
            <tr style="background-color:#FF0000; COLOR:WHITE;">
                <td>DEIT < 1</td>
                <td>More Downgrades vs Upgrades</td>
            </tr>
        </table><br><br></div>
    </div>
    <div style="width:1220px; height:60px; padding:15px;background-color:#0066B3">
    <h3><center style="color:white;">Sector - Wise Aggregate Numbers</center></h3>
</div>
    <table class="sectortable">
        <tr>
            <th rowspan="2">sector Name(RS mn)</th>
            <th rowspan="2" colspan="3">rating Upgrade/Downgraded*</th>
            <th colspan="2">Sales</th>
            <th colspan="2">EBITDA</th>
            <th colspan="2">PAT</th>
            <th rowspan="2">Number of Result Realeased</th>
        </tr>
        <tr>
            <th>Q2FY22</th>
            <th>YoY(%)</th>
            <th>Q2FY22</th>
            <th>YoY(%)</th>
            <th>Q2FY22</th>
            <th>YoY(%)</th>
        </tr>
        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>

        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Agri Inputs</td>
            <td>1</td>
            <td class="r1">4</td>
            <td>0</td>
            <td>137,306</td>
            <td class="rate">17.5%</td>
            <td>24,829</td>
            <td class="rate">11.8%</td>
            <td>10,463</td>
            <td class="rate">1.0%</td>
            <td>5</td>
        </tr>
    </table>

    Note: *This reflect change in rating from Previous rating (Rating - Buy/Accumulate/Reduce/Sell), $ IT Services is EBIT fig and not EBITDA
<br>
    <p><b style="background-color: #92D050; color:#92D050 ;witdh:20px;">Upgrade;</b><b style="background-color: #0066B3;color: #0066B3;witdh:20px;">Neutral;</b><b style="background-color: #FF0000;color:#ff0000 ;witdh:20px;">Downgrade;</b><br>UPGRADE &nbsp;
        NEUTRAL&nbsp;
        DOWNGRADE&nbsp;</p>

<br>
<br>
    <div class="Indexdiet">
        <div style="width:1220px; height:60px; padding:15px;background-color:#0066B3">
            <h3><center style="color:white;">Latest 15 Stocks Earning Summary</center></h3>
        </div>
        <table class="stockdata">
            <tr>
                <td class="stockdata">
                    NRB Bearings (TP:182,+22% vs CMP: 149), EPS Growth (FY22E: NA, FY23E: +30%), EPS Rev (FY22E: -2%, FY23E: +2%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Amara Raja Batteries (TP:687,+6% vs CMP: 648), EPS Growth (FY22E: -4%, FY23E: +18%), EPS Rev (FY22E: -14%, FY23E: -11%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Garden Reach Shipbuilders (TP:375,+51% vs CMP: 248), EPS Growth (FY22E: +26%, FY23E: +38%), EPS Rev (FY22E: +0%, FY23E: +0%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Jamna Auto Industries (TP:133,+20% vs CMP: 111), EPS Growth (FY22E: +71%, FY23E: +45%), EPS Rev (FY22E: -7%, FY23E: -6%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    SML ISUZU (TP:589,-19% vs CMP: 728), EPS Growth (FY22E: -41%, FY23E: -127%), EPS Rev (FY22E: NA, FY23E: -35%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    JBM Auto (TP:1192,+34% vs CMP: 890), EPS Growth (FY22E: +114%, FY23E: +41%), EPS Rev (FY22E: +13%, FY23E: +7%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    IPCA Loboratories (TP:2462,+14% vs CMP: 2153), EPS Growth (FY22E: -7%, FY23E: +20%), EPS Rev (FY22E: -6%, FY23E: -6%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Lumax Auto Technologies (TP:217,+49% vs CMP: 146), EPS Growth (FY22E: +44%, FY23E: +36%), EPS Rev (FY22E: +5%, FY23E: +6%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    JK Cement (TP:3734,+6% vs CMP: 3518), EPS Growth (FY22E: -25%, FY23E: +21%), EPS Rev (FY22E: -7%, FY23E: -8%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Lumax Industries (TP:1617,+13% vs CMP: 1434), EPS Growth (FY22E: +114%, FY23E: +100%), EPS Rev (FY22E: -19%, FY23E: -1%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    KNR Constructions (TP:320,+13% vs CMP: 282), EPS Growth (FY22E: +22%, FY23E: +32%), EPS Rev (FY22E: +5%, FY23E: +4%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">

                    National Aluminium Company (TP:199,+99% vs CMP: 100), EPS Growth (FY22E: +153%, FY23E: +31%), EPS Rev (FY22E: +0%, FY23E: -17%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    Coal India (TP:270,+69% vs CMP: 160), EPS Growth (FY22E: +85%, FY23E: +14%), EPS Rev (FY22E: -5%, FY23E: -0%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    NMDC (TP:270,+93% vs CMP: 140), EPS Growth (FY22E: +69%, FY23E: +13%), EPS Rev (FY22E: +0%, FY23E: +10%)
                </td>
            </tr>
            <tr>
                <td class="stockdata">
                    PNC Infratech (TP:458,+39% vs CMP: 329), EPS Growth (FY22E: +40%, FY23E: +17%), EPS Rev (FY22E: +4%, FY23E: -3%)
                </td>
            </tr>
        </table>
    </div>
</div>


<script>

Function.prototype.bind = Function.prototype.bind || function (thisp) {
    var fn = this;
    return function () {
        return fn.apply(thisp, arguments);
    };
};
    // setup
    const data = {
      labels: ['Q2FY20', 'Q3FY20', 'Q4FY20', 'Q1FY21','Q2FY21', 'Q3FY21', 'Q4FY21', 'Q1FY22', 'Q2FY22'],
      datasets: [{
              label: 'UPGRADE Vs DOWNGRADE',

                data: [1.2, 1.1, 0.4, 2.3,3.9 ,4.4,1.0,3.1,1.1],
       animation: {
                    duration: 0, // general animation time
                },
                hover: {
                    animationDuration: 0, // duration of animations when hovering an item
                },
                responsiveAnimationDuration: 0,

        backgroundColor: [
                    '#92D050',
                    '#92D050',
                    '#FF0000',
                    '#92D050',
                    '#92D050',
                    '#92D050',
                    '#00B0F0',
                    '#92D050',
                    '#92D050'


        ],
        borderColor: [
          '#92D050'
        ],
        borderWidth: 1
      }]
    };
    // config
    const config = {
                "responsive": false,
      type: 'bar',
      data,
      options: {
        scales: {
         gridLines: {
            display: false
            },
          y: {
            beginAtZero: true,
            beginAtZero: true,
            }
        }
      },

       };

    // render init block
    const myChart = new Chart(
      document.getElementById('myChart'),
      config
    );
</script>
<script>

function Convert_HTML_To_PDF() {
  var elementHTML = document.getElementById('contentToPrint');

  html2canvas(elementHTML, {
    useCORS: true,

    onrendered: function(canvas) {
      var pdf = new jsPDF('l', 'px','a3');
      var scaleBy =5;
      var pageHeight =900;
      var pageWidth = 1800;
      for (var i = 0; i <= elementHTML.clientHeight / pageHeight; i++) {
        var srcImg = canvas;
        var sX = 0;
        var sY = pageHeight * i; // start 1 pageHeight down for every new page
        var sWidth = pageWidth;
        var sHeight = pageHeight;
        var dX = 0;
        var dY = 0;
        var dWidth = 1500;
        var dHeight = 900;

        window.onePageCanvas = document.createElement("canvas");
        onePageCanvas.setAttribute('width', pageWidth);
        onePageCanvas.setAttribute('height', pageHeight);
        var ctx = onePageCanvas.getContext('2d');

        ctx.drawImage(srcImg, sX, sY, sWidth, sHeight, dX, dY, dWidth, dHeight);

        var canvasDataURL = onePageCanvas.toDataURL("image/png", 1.0);
        var width = onePageCanvas.width;
        var height = onePageCanvas.clientHeight;

        if (i > 0) // if we're on anything other than the first page, add another page
          pdf.addPage(900,800 ); // 8.5" x 12" in pts (inches*72)

        pdf.setPage(i + 1); // now we declare that we're working on that page
        pdf.addImage(canvasDataURL, 'PNG',10, 20, (width * .62),(height)); // add content to the page
      }

	  // Save the PDF
      pdf.save('DETIINDEX.pdf');
    }
  });
}


</script>
